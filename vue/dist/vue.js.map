{"version":3,"file":"vue.js","sources":["../src/observe/arr.js","../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["let oldArray = Array.prototype\r\n// 继承\r\nexport let newArray = Object.create(oldArray)\r\n// 需要劫持的几个常用数组方法（只对methods中的几个数组方法进行劫持）\r\nlet methods = [\r\n  \"push\",\r\n  \"pop\",\r\n  \"unshift\",\r\n  \"shift\",\r\n  \"splice\"\r\n]\r\nmethods.forEach(method => {\r\n  newArray[method] = function (...args) {\r\n    console.log(\"执行了\" + method + \"方法。。。\")//方法劫持\r\n    let result = oldArray[method].apply(this, args)\r\n    return result\r\n  }\r\n})","import {newArray} from './arr'\r\nexport function observer(data){\r\n  console.log(\"observer\", data)\r\n  // 1对象\r\n  if(typeof data!==\"object\" || data===null){\r\n    return data;\r\n  }\r\n  return new Observer(data);\r\n  // 2数组\r\n}\r\nclass Observer{\r\n  constructor(value){\r\n    if(value instanceof Array){\r\n      // 处理数组\r\n      value.__proto__ = newArray\r\n      this.observeArray(value)\r\n    }else{\r\n      this.walk(value);//遍历对象\r\n    }\r\n  }\r\n  walk(data){\r\n    let keys = Object.keys(data);\r\n    for(let i = 0; i < keys.length; i++){\r\n      let key = keys[i];\r\n      let value = data[key];\r\n      defineReactive(data, key, value);\r\n    }\r\n  }\r\n  observeArray(data){\r\n    for(let i = 0; i< data.length; i++){\r\n      observer(data[i])\r\n      /**\r\n       * 数组中每一项进行观测，在observer方法中，会进行判断，只有对对象类型的才会进行监听（walk方法）\r\n       * 而普通类型的数据不会走walk方法，自然就不会被监听\r\n       * 例如var list = [1, \"hello\", {a:1}]；对于list这个数组，只有下标为2的这一项才会是被劫持，前两项不会被劫持（不具有相应式）\r\n       * */ \r\n    }\r\n  }\r\n}\r\nfunction defineReactive(data, key, value){\r\n  // console.log(\"defineReactive\", data, key, value)\r\n  observer(value)//递归劫持\r\n  Object.defineProperty(data, key, {\r\n    get(){\r\n      console.log(\"get\", value)\r\n      return value\r\n    },\r\n    set(newValue){\r\n      console.log(\"set\", newValue);\r\n      if(newValue === value) return;\r\n      value = newValue;\r\n      observer(value);//处理设置对象问题例如把o={a:1,b:{c:1}}通过o.b={d:1}，变成了o={a:1,b:{d:1}}\r\n    }\r\n  })\r\n}","import { observer } from \"./observe/index.js\";\r\nexport function initState(vm){\r\n  let opts = vm.$options;\r\n  console.log(\"initState\",opts)\r\n  if(opts.props){\r\n    initProps();\r\n  }\r\n  if(opts.methods){\r\n    initMethods(vm);\r\n  }\r\n  if(opts.data){\r\n    initData(vm);\r\n  }\r\n  if(opts.computed){\r\n    initComputed(vm);\r\n  }\r\n  if(opts.watch){\r\n    initWatch(vm);\r\n  }\r\n}\r\nfunction initProps(vm){}\r\nfunction initMethods(vm){}\r\n// vue2对data初始化\r\nfunction initData(vm){\r\n  console.log(\"data初始化\");\r\n  let data = vm.$options.data;\r\n  data = vm._data = typeof data === \"function\" ? data.call(vm) : data;\r\n  console.log(data)\r\n  // 对data进行劫持\r\n  observer(data);//data分为对象和数组两种情况\r\n}\r\nfunction initComputed(vm){}\r\nfunction initWatch(vm){}","import {initState} from './initState'\r\nexport function initMixin(Vue){\r\n  Vue.prototype._init = function(options){\r\n    console.log('init');\r\n    console.log(options);\r\n    let vm = this;\r\n    vm.$options = options;\r\n    initState(vm);\r\n  }\r\n}","import {initMixin} from './init'\r\nfunction Vue(options){\r\n  // 初始化\r\n  this._init(options);\r\n}\r\ninitMixin(Vue)\r\nexport default Vue;"],"names":[],"mappings":"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"}